{"version":3,"file":"frontend/gallery-justified.js","mappings":"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","sources":["webpack://onepress/./src/frontend/libs/gallery/jquery.justified.js","webpack://onepress/external window \"jQuery\"","webpack://onepress/webpack/bootstrap","webpack://onepress/webpack/before-startup","webpack://onepress/webpack/startup","webpack://onepress/webpack/after-startup"],"sourcesContent":["/*!\n * justifiedGallery - v3.8.1\n * http://miromannino.github.io/Justified-Gallery/\n * Copyright (c) 2020 Miro Mannino\n * Licensed under the MIT license.\n */\n(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['jquery'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    // Node/CommonJS\n    module.exports = function (root, jQuery) {\n      if (jQuery === undefined) {\n        // require('jQuery') returns a factory that requires window to\n        // build a jQuery instance, we normalize how we use modules\n        // that require this pattern but the window provided is a noop\n        // if it's defined (how jquery works)\n        if (typeof window !== 'undefined') {\n          jQuery = require('jquery');\n        }\n        else {\n          jQuery = require('jquery')(root);\n        }\n      }\n      factory(jQuery);\n      return jQuery;\n    };\n  } else {\n    // Browser globals\n    factory(jQuery);\n  }\n}(function ($) {\n\n  /**\n   * Justified Gallery controller constructor\n   *\n   * @param $gallery the gallery to build\n   * @param settings the settings (the defaults are in JustifiedGallery.defaults)\n   * @constructor\n   */\n  var JustifiedGallery = function ($gallery, settings) {\n  \n    this.settings = settings;\n    this.checkSettings();\n  \n    this.imgAnalyzerTimeout = null;\n    this.entries = null;\n    this.buildingRow = {\n      entriesBuff: [],\n      width: 0,\n      height: 0,\n      aspectRatio: 0\n    };\n    this.lastFetchedEntry = null;\n    this.lastAnalyzedIndex = -1;\n    this.yield = {\n      every: 2, // do a flush every n flushes (must be greater than 1)\n      flushed: 0 // flushed rows without a yield\n    };\n    this.border = settings.border >= 0 ? settings.border : settings.margins;\n    this.maxRowHeight = this.retrieveMaxRowHeight();\n    this.suffixRanges = this.retrieveSuffixRanges();\n    this.offY = this.border;\n    this.rows = 0;\n    this.spinner = {\n      phase: 0,\n      timeSlot: 150,\n      $el: $('<div class=\"jg-spinner\"><span></span><span></span><span></span></div>'),\n      intervalId: null\n    };\n    this.scrollBarOn = false;\n    this.checkWidthIntervalId = null;\n    this.galleryWidth = $gallery.width();\n    this.$gallery = $gallery;\n  \n  };\n  \n  /** @returns {String} the best suffix given the width and the height */\n  JustifiedGallery.prototype.getSuffix = function (width, height) {\n    var longestSide, i;\n    longestSide = (width > height) ? width : height;\n    for (i = 0; i < this.suffixRanges.length; i++) {\n      if (longestSide <= this.suffixRanges[i]) {\n        return this.settings.sizeRangeSuffixes[this.suffixRanges[i]];\n      }\n    }\n    return this.settings.sizeRangeSuffixes[this.suffixRanges[i - 1]];\n  };\n  \n  /**\n   * Remove the suffix from the string\n   *\n   * @returns {string} a new string without the suffix\n   */\n  JustifiedGallery.prototype.removeSuffix = function (str, suffix) {\n    return str.substring(0, str.length - suffix.length);\n  };\n  \n  /**\n   * @returns {boolean} a boolean to say if the suffix is contained in the str or not\n   */\n  JustifiedGallery.prototype.endsWith = function (str, suffix) {\n    return str.indexOf(suffix, str.length - suffix.length) !== -1;\n  };\n  \n  /**\n   * Get the used suffix of a particular url\n   *\n   * @param str\n   * @returns {String} return the used suffix\n   */\n  JustifiedGallery.prototype.getUsedSuffix = function (str) {\n    for (var si in this.settings.sizeRangeSuffixes) {\n      if (this.settings.sizeRangeSuffixes.hasOwnProperty(si)) {\n        if (this.settings.sizeRangeSuffixes[si].length === 0) continue;\n        if (this.endsWith(str, this.settings.sizeRangeSuffixes[si])) return this.settings.sizeRangeSuffixes[si];\n      }\n    }\n    return '';\n  };\n  \n  /**\n   * Given an image src, with the width and the height, returns the new image src with the\n   * best suffix to show the best quality thumbnail.\n   *\n   * @returns {String} the suffix to use\n   */\n  JustifiedGallery.prototype.newSrc = function (imageSrc, imgWidth, imgHeight, image) {\n    var newImageSrc;\n  \n    if (this.settings.thumbnailPath) {\n      newImageSrc = this.settings.thumbnailPath(imageSrc, imgWidth, imgHeight, image);\n    } else {\n      var matchRes = imageSrc.match(this.settings.extension);\n      var ext = (matchRes !== null) ? matchRes[0] : '';\n      newImageSrc = imageSrc.replace(this.settings.extension, '');\n      newImageSrc = this.removeSuffix(newImageSrc, this.getUsedSuffix(newImageSrc));\n      newImageSrc += this.getSuffix(imgWidth, imgHeight) + ext;\n    }\n  \n    return newImageSrc;\n  };\n  \n  /**\n   * Shows the images that is in the given entry\n   *\n   * @param $entry the entry\n   * @param callback the callback that is called when the show animation is finished\n   */\n  JustifiedGallery.prototype.showImg = function ($entry, callback) {\n    if (this.settings.cssAnimation) {\n      $entry.addClass('jg-entry-visible');\n      if (callback) callback();\n    } else {\n      $entry.stop().fadeTo(this.settings.imagesAnimationDuration, 1.0, callback);\n      $entry.find(this.settings.imgSelector).stop().fadeTo(this.settings.imagesAnimationDuration, 1.0, callback);\n    }\n  };\n  \n  /**\n   * Extract the image src form the image, looking from the 'safe-src', and if it can't be found, from the\n   * 'src' attribute. It saves in the image data the 'jg.originalSrc' field, with the extracted src.\n   *\n   * @param $image the image to analyze\n   * @returns {String} the extracted src\n   */\n  JustifiedGallery.prototype.extractImgSrcFromImage = function ($image) {\n    var imageSrc = $image.data('safe-src');\n    var imageSrcLoc = 'data-safe-src';\n    if (typeof imageSrc === 'undefined') {\n      imageSrc = $image.attr('src');\n      imageSrcLoc = 'src';\n    }\n    $image.data('jg.originalSrc', imageSrc); // this is saved for the destroy method\n    $image.data('jg.src', imageSrc); // this will change overtime\n    $image.data('jg.originalSrcLoc', imageSrcLoc); // this is saved for the destroy method\n    return imageSrc;\n  };\n  \n  /** @returns {jQuery} the image in the given entry */\n  JustifiedGallery.prototype.imgFromEntry = function ($entry) {\n    var $img = $entry.find(this.settings.imgSelector);\n    return $img.length === 0 ? null : $img;\n  };\n  \n  /** @returns {jQuery} the caption in the given entry */\n  JustifiedGallery.prototype.captionFromEntry = function ($entry) {\n    var $caption = $entry.find('> .jg-caption');\n    return $caption.length === 0 ? null : $caption;\n  };\n  \n  /**\n   * Display the entry\n   *\n   * @param {jQuery} $entry the entry to display\n   * @param {int} x the x position where the entry must be positioned\n   * @param y the y position where the entry must be positioned\n   * @param imgWidth the image width\n   * @param imgHeight the image height\n   * @param rowHeight the row height of the row that owns the entry\n   */\n  JustifiedGallery.prototype.displayEntry = function ($entry, x, y, imgWidth, imgHeight, rowHeight) {\n    $entry.width(imgWidth);\n    $entry.height(rowHeight);\n    $entry.css('top', y);\n    $entry.css('left', x);\n  \n    var $image = this.imgFromEntry($entry);\n    if ($image !== null) {\n      $image.css('width', imgWidth);\n      $image.css('height', imgHeight);\n      $image.css('margin-left', - imgWidth / 2);\n      $image.css('margin-top', - imgHeight / 2);\n  \n      // Image reloading for an high quality of thumbnails\n      var imageSrc = $image.data('jg.src');\n      if (imageSrc) {\n        imageSrc = this.newSrc(imageSrc, imgWidth, imgHeight, $image[0]);\n  \n        $image.one('error', function () {\n           this.resetImgSrc($image); //revert to the original thumbnail\n        });\n  \n        var loadNewImage = function () {\n          // if (imageSrc !== newImageSrc) { \n            $image.attr('src', imageSrc);\n          // }\n        };\n  \n        if ($entry.data('jg.loaded') === 'skipped' && imageSrc) {\n          this.onImageEvent(imageSrc, (function() {\n            this.showImg($entry, loadNewImage); //load the new image after the fadeIn\n            $entry.data('jg.loaded', true);\n          }).bind(this));\n        } else {\n          this.showImg($entry, loadNewImage); //load the new image after the fadeIn\n        }\n      \n      }\n  \n    } else {\n      this.showImg($entry);\n    }\n  \n    this.displayEntryCaption($entry);\n  };\n  \n  /**\n   * Display the entry caption. If the caption element doesn't exists, it creates the caption using the 'alt'\n   * or the 'title' attributes.\n   *\n   * @param {jQuery} $entry the entry to process\n   */\n  JustifiedGallery.prototype.displayEntryCaption = function ($entry) {\n    var $image = this.imgFromEntry($entry);\n    if ($image !== null && this.settings.captions) {\n      var $imgCaption = this.captionFromEntry($entry);\n  \n      // Create it if it doesn't exists\n      if ($imgCaption === null) {\n        var caption = $image.attr('alt');\n        if (!this.isValidCaption(caption)) caption = $entry.attr('title');\n        if (this.isValidCaption(caption)) { // Create only we found something\n          $imgCaption = $('<div class=\"jg-caption\">' + caption + '</div>');\n          $entry.append($imgCaption);\n          $entry.data('jg.createdCaption', true);\n        }\n      }\n  \n      // Create events (we check again the $imgCaption because it can be still inexistent)\n      if ($imgCaption !== null) {\n        if (!this.settings.cssAnimation) $imgCaption.stop().fadeTo(0, this.settings.captionSettings.nonVisibleOpacity);\n        this.addCaptionEventsHandlers($entry);\n      }\n    } else {\n      this.removeCaptionEventsHandlers($entry);\n    }\n  };\n  \n  /**\n   * Validates the caption\n   *\n   * @param caption The caption that should be validated\n   * @return {boolean} Validation result\n   */\n  JustifiedGallery.prototype.isValidCaption = function (caption) {\n    return (typeof caption !== 'undefined' && caption.length > 0);\n  };\n  \n  /**\n   * The callback for the event 'mouseenter'. It assumes that the event currentTarget is an entry.\n   * It shows the caption using jQuery (or using CSS if it is configured so)\n   *\n   * @param {Event} eventObject the event object\n   */\n  JustifiedGallery.prototype.onEntryMouseEnterForCaption = function (eventObject) {\n    var $caption = this.captionFromEntry($(eventObject.currentTarget));\n    if (this.settings.cssAnimation) {\n      $caption.addClass('jg-caption-visible').removeClass('jg-caption-hidden');\n    } else {\n      $caption.stop().fadeTo(this.settings.captionSettings.animationDuration,\n        this.settings.captionSettings.visibleOpacity);\n    }\n  };\n  \n  /**\n   * The callback for the event 'mouseleave'. It assumes that the event currentTarget is an entry.\n   * It hides the caption using jQuery (or using CSS if it is configured so)\n   *\n   * @param {Event} eventObject the event object\n   */\n  JustifiedGallery.prototype.onEntryMouseLeaveForCaption = function (eventObject) {\n    var $caption = this.captionFromEntry($(eventObject.currentTarget));\n    if (this.settings.cssAnimation) {\n      $caption.removeClass('jg-caption-visible').removeClass('jg-caption-hidden');\n    } else {\n      $caption.stop().fadeTo(this.settings.captionSettings.animationDuration,\n        this.settings.captionSettings.nonVisibleOpacity);\n    }\n  };\n  \n  /**\n   * Add the handlers of the entry for the caption\n   *\n   * @param $entry the entry to modify\n   */\n  JustifiedGallery.prototype.addCaptionEventsHandlers = function ($entry) {\n    var captionMouseEvents = $entry.data('jg.captionMouseEvents');\n    if (typeof captionMouseEvents === 'undefined') {\n      captionMouseEvents = {\n        mouseenter: $.proxy(this.onEntryMouseEnterForCaption, this),\n        mouseleave: $.proxy(this.onEntryMouseLeaveForCaption, this)\n      };\n      $entry.on('mouseenter', undefined, undefined, captionMouseEvents.mouseenter);\n      $entry.on('mouseleave', undefined, undefined, captionMouseEvents.mouseleave);\n      $entry.data('jg.captionMouseEvents', captionMouseEvents);\n    }\n  };\n  \n  /**\n   * Remove the handlers of the entry for the caption\n   *\n   * @param $entry the entry to modify\n   */\n  JustifiedGallery.prototype.removeCaptionEventsHandlers = function ($entry) {\n    var captionMouseEvents = $entry.data('jg.captionMouseEvents');\n    if (typeof captionMouseEvents !== 'undefined') {\n      $entry.off('mouseenter', undefined, captionMouseEvents.mouseenter);\n      $entry.off('mouseleave', undefined, captionMouseEvents.mouseleave);\n      $entry.removeData('jg.captionMouseEvents');\n    }\n  };\n  \n  /**\n   * Clear the building row data to be used for a new row\n   */\n  JustifiedGallery.prototype.clearBuildingRow = function () {\n    this.buildingRow.entriesBuff = [];\n    this.buildingRow.aspectRatio = 0;\n    this.buildingRow.width = 0;\n  };\n  \n  /**\n   * Justify the building row, preparing it to\n   *\n   * @param isLastRow\n   * @param hiddenRow undefined or false for normal behavior. hiddenRow = true to hide the row.\n   * @returns a boolean to know if the row has been justified or not\n   */\n  JustifiedGallery.prototype.prepareBuildingRow = function (isLastRow, hiddenRow) {\n    var i, $entry, imgAspectRatio, newImgW, newImgH, justify = true;\n    var minHeight = 0;\n    var availableWidth = this.galleryWidth - 2 * this.border - (\n      (this.buildingRow.entriesBuff.length - 1) * this.settings.margins);\n    var rowHeight = availableWidth / this.buildingRow.aspectRatio;\n    var defaultRowHeight = this.settings.rowHeight;\n    var justifiable = this.buildingRow.width / availableWidth > this.settings.justifyThreshold;\n  \n    //Skip the last row if we can't justify it and the lastRow == 'hide'\n    if (hiddenRow || (isLastRow && this.settings.lastRow === 'hide' && !justifiable)) {\n      for (i = 0; i < this.buildingRow.entriesBuff.length; i++) {\n        $entry = this.buildingRow.entriesBuff[i];\n        if (this.settings.cssAnimation)\n          $entry.removeClass('jg-entry-visible');\n        else {\n          $entry.stop().fadeTo(0, 0.1);\n          $entry.find('> img, > a > img').fadeTo(0, 0);\n        }\n      }\n      return -1;\n    }\n  \n    // With lastRow = nojustify, justify if is justificable (the images will not become too big)\n    if (isLastRow && !justifiable && this.settings.lastRow !== 'justify' && this.settings.lastRow !== 'hide') {\n      justify = false;\n  \n      if (this.rows > 0) {\n        defaultRowHeight = (this.offY - this.border - this.settings.margins * this.rows) / this.rows;\n        justify = defaultRowHeight * this.buildingRow.aspectRatio / availableWidth > this.settings.justifyThreshold;\n      }\n    }\n  \n    for (i = 0; i < this.buildingRow.entriesBuff.length; i++) {\n      $entry = this.buildingRow.entriesBuff[i];\n      imgAspectRatio = $entry.data('jg.width') / $entry.data('jg.height');\n  \n      if (justify) {\n        newImgW = (i === this.buildingRow.entriesBuff.length - 1) ? availableWidth : rowHeight * imgAspectRatio;\n        newImgH = rowHeight;\n      } else {\n        newImgW = defaultRowHeight * imgAspectRatio;\n        newImgH = defaultRowHeight;\n      }\n  \n      availableWidth -= Math.round(newImgW);\n      $entry.data('jg.jwidth', Math.round(newImgW));\n      $entry.data('jg.jheight', Math.ceil(newImgH));\n      if (i === 0 || minHeight > newImgH) minHeight = newImgH;\n    }\n  \n    this.buildingRow.height = minHeight;\n    return justify;\n  };\n  \n  /**\n   * Flush a row: justify it, modify the gallery height accordingly to the row height\n   *\n   * @param isLastRow\n   * @param hiddenRow undefined or false for normal behavior. hiddenRow = true to hide the row.\n   */\n  JustifiedGallery.prototype.flushRow = function (isLastRow, hiddenRow) {\n    var settings = this.settings;\n    var $entry, buildingRowRes, offX = this.border, i;\n  \n    buildingRowRes = this.prepareBuildingRow(isLastRow, hiddenRow);\n    if (hiddenRow || (isLastRow && settings.lastRow === 'hide' && buildingRowRes === -1)) {\n      this.clearBuildingRow();\n      return;\n    }\n  \n    if (this.maxRowHeight) {\n      if (this.maxRowHeight < this.buildingRow.height) this.buildingRow.height = this.maxRowHeight;\n    }\n  \n    //Align last (unjustified) row\n    if (isLastRow && (settings.lastRow === 'center' || settings.lastRow === 'right')) {\n      var availableWidth = this.galleryWidth - 2 * this.border - (this.buildingRow.entriesBuff.length - 1) * settings.margins;\n  \n      for (i = 0; i < this.buildingRow.entriesBuff.length; i++) {\n        $entry = this.buildingRow.entriesBuff[i];\n        availableWidth -= $entry.data('jg.jwidth');\n      }\n  \n      if (settings.lastRow === 'center')\n        offX += Math.round(availableWidth / 2);\n      else if (settings.lastRow === 'right')\n        offX += availableWidth;\n    }\n  \n    var lastEntryIdx = this.buildingRow.entriesBuff.length - 1;\n    for (i = 0; i <= lastEntryIdx; i++) {\n      $entry = this.buildingRow.entriesBuff[this.settings.rtl ? lastEntryIdx - i : i];\n      this.displayEntry($entry, offX, this.offY, $entry.data('jg.jwidth'), $entry.data('jg.jheight'), this.buildingRow.height);\n      offX += $entry.data('jg.jwidth') + settings.margins;\n    }\n  \n    //Gallery Height\n    this.galleryHeightToSet = this.offY + this.buildingRow.height + this.border;\n    this.setGalleryTempHeight(this.galleryHeightToSet + this.getSpinnerHeight());\n  \n    if (!isLastRow || (this.buildingRow.height <= settings.rowHeight && buildingRowRes)) {\n      //Ready for a new row\n      this.offY += this.buildingRow.height + settings.margins;\n      this.rows += 1;\n      this.clearBuildingRow();\n      this.settings.triggerEvent.call(this, 'jg.rowflush');\n    }\n  };\n  \n  \n  // Scroll position not restoring: https://github.com/miromannino/Justified-Gallery/issues/221\n  var galleryPrevStaticHeight = 0;\n  \n  JustifiedGallery.prototype.rememberGalleryHeight = function () {\n    galleryPrevStaticHeight = this.$gallery.height();\n    this.$gallery.height(galleryPrevStaticHeight);\n  };\n  \n  // grow only\n  JustifiedGallery.prototype.setGalleryTempHeight = function (height) {\n    galleryPrevStaticHeight = Math.max(height, galleryPrevStaticHeight);\n    this.$gallery.height(galleryPrevStaticHeight);\n  };\n  \n  JustifiedGallery.prototype.setGalleryFinalHeight = function (height) {\n    galleryPrevStaticHeight = height;\n    this.$gallery.height(height);\n  };\n  \n  /**\n   * Checks the width of the gallery container, to know if a new justification is needed\n   */\n  JustifiedGallery.prototype.checkWidth = function () {\n    this.checkWidthIntervalId = setInterval($.proxy(function () {\n  \n      // if the gallery is not currently visible, abort.\n      if (!this.$gallery.is(\":visible\")) return;\n  \n      var galleryWidth = parseFloat(this.$gallery.width());\n      if (Math.abs(galleryWidth - this.galleryWidth) > this.settings.refreshSensitivity) {\n        this.galleryWidth = galleryWidth;\n        this.rewind();\n  \n        this.rememberGalleryHeight();\n  \n        // Restart to analyze\n        this.startImgAnalyzer(true);\n      }\n    }, this), this.settings.refreshTime);\n  };\n  \n  /**\n   * @returns {boolean} a boolean saying if the spinner is active or not\n   */\n  JustifiedGallery.prototype.isSpinnerActive = function () {\n    return this.spinner.intervalId !== null;\n  };\n  \n  /**\n   * @returns {int} the spinner height\n   */\n  JustifiedGallery.prototype.getSpinnerHeight = function () {\n    return this.spinner.$el.innerHeight();\n  };\n  \n  /**\n   * Stops the spinner animation and modify the gallery height to exclude the spinner\n   */\n  JustifiedGallery.prototype.stopLoadingSpinnerAnimation = function () {\n    clearInterval(this.spinner.intervalId);\n    this.spinner.intervalId = null;\n    this.setGalleryTempHeight(this.$gallery.height() - this.getSpinnerHeight());\n    this.spinner.$el.detach();\n  };\n  \n  /**\n   * Starts the spinner animation\n   */\n  JustifiedGallery.prototype.startLoadingSpinnerAnimation = function () {\n    var spinnerContext = this.spinner;\n    var $spinnerPoints = spinnerContext.$el.find('span');\n    clearInterval(spinnerContext.intervalId);\n    this.$gallery.append(spinnerContext.$el);\n    this.setGalleryTempHeight(this.offY + this.buildingRow.height + this.getSpinnerHeight());\n    spinnerContext.intervalId = setInterval(function () {\n      if (spinnerContext.phase < $spinnerPoints.length) {\n        $spinnerPoints.eq(spinnerContext.phase).fadeTo(spinnerContext.timeSlot, 1);\n      } else {\n        $spinnerPoints.eq(spinnerContext.phase - $spinnerPoints.length).fadeTo(spinnerContext.timeSlot, 0);\n      }\n      spinnerContext.phase = (spinnerContext.phase + 1) % ($spinnerPoints.length * 2);\n    }, spinnerContext.timeSlot);\n  };\n  \n  /**\n   * Rewind the image analysis to start from the first entry.\n   */\n  JustifiedGallery.prototype.rewind = function () {\n    this.lastFetchedEntry = null;\n    this.lastAnalyzedIndex = -1;\n    this.offY = this.border;\n    this.rows = 0;\n    this.clearBuildingRow();\n  };\n  \n  /**\n   * @returns {String} `settings.selector` rejecting spinner element\n   */\n  JustifiedGallery.prototype.getSelectorWithoutSpinner = function () {\n    return this.settings.selector + ', div:not(.jg-spinner)';\n  };\n  \n  /**\n   * @returns {Array} all entries matched by `settings.selector`\n   */\n  JustifiedGallery.prototype.getAllEntries = function () {\n    var selector = this.getSelectorWithoutSpinner();\n    return this.$gallery.children(selector).toArray();\n  };\n  \n  /**\n   * Update the entries searching it from the justified gallery HTML element\n   *\n   * @param norewind if norewind only the new entries will be changed (i.e. randomized, sorted or filtered)\n   * @returns {boolean} true if some entries has been founded\n   */\n  JustifiedGallery.prototype.updateEntries = function (norewind) {\n    var newEntries;\n  \n    if (norewind && this.lastFetchedEntry != null) {\n      var selector = this.getSelectorWithoutSpinner();\n      newEntries = $(this.lastFetchedEntry).nextAll(selector).toArray();\n    } else {\n      this.entries = [];\n      newEntries = this.getAllEntries();\n    }\n  \n    if (newEntries.length > 0) {\n  \n      // Sort or randomize\n      if ($.isFunction(this.settings.sort)) {\n        newEntries = this.sortArray(newEntries);\n      } else if (this.settings.randomize) {\n        newEntries = this.shuffleArray(newEntries);\n      }\n      this.lastFetchedEntry = newEntries[newEntries.length - 1];\n  \n      // Filter\n      if (this.settings.filter) {\n        newEntries = this.filterArray(newEntries);\n      } else {\n        this.resetFilters(newEntries);\n      }\n  \n    }\n  \n    this.entries = this.entries.concat(newEntries);\n    return true;\n  };\n  \n  /**\n   * Apply the entries order to the DOM, iterating the entries and appending the images\n   *\n   * @param entries the entries that has been modified and that must be re-ordered in the DOM\n   */\n  JustifiedGallery.prototype.insertToGallery = function (entries) {\n    var that = this;\n    $.each(entries, function () {\n      $(this).appendTo(that.$gallery);\n    });\n  };\n  \n  /**\n   * Shuffle the array using the Fisher-Yates shuffle algorithm\n   *\n   * @param a the array to shuffle\n   * @return the shuffled array\n   */\n  JustifiedGallery.prototype.shuffleArray = function (a) {\n    var i, j, temp;\n    for (i = a.length - 1; i > 0; i--) {\n      j = Math.floor(Math.random() * (i + 1));\n      temp = a[i];\n      a[i] = a[j];\n      a[j] = temp;\n    }\n    this.insertToGallery(a);\n    return a;\n  };\n  \n  /**\n   * Sort the array using settings.comparator as comparator\n   *\n   * @param a the array to sort (it is sorted)\n   * @return the sorted array\n   */\n  JustifiedGallery.prototype.sortArray = function (a) {\n    a.sort(this.settings.sort);\n    this.insertToGallery(a);\n    return a;\n  };\n  \n  /**\n   * Reset the filters removing the 'jg-filtered' class from all the entries\n   *\n   * @param a the array to reset\n   */\n  JustifiedGallery.prototype.resetFilters = function (a) {\n    for (var i = 0; i < a.length; i++) $(a[i]).removeClass('jg-filtered');\n  };\n  \n  /**\n   * Filter the entries considering theirs classes (if a string has been passed) or using a function for filtering.\n   *\n   * @param a the array to filter\n   * @return the filtered array\n   */\n  JustifiedGallery.prototype.filterArray = function (a) {\n    var settings = this.settings;\n    if ($.type(settings.filter) === 'string') {\n      // Filter only keeping the entries passed in the string\n      return a.filter(function (el) {\n        var $el = $(el);\n        if ($el.is(settings.filter)) {\n          $el.removeClass('jg-filtered');\n          return true;\n        } else {\n          $el.addClass('jg-filtered').removeClass('jg-visible');\n          return false;\n        }\n      });\n    } else if ($.isFunction(settings.filter)) {\n      // Filter using the passed function\n      var filteredArr = a.filter(settings.filter);\n      for (var i = 0; i < a.length; i++) {\n        if (filteredArr.indexOf(a[i]) === -1) {\n          $(a[i]).addClass('jg-filtered').removeClass('jg-visible');\n        } else {\n          $(a[i]).removeClass('jg-filtered');\n        }\n      }\n      return filteredArr;\n    }\n  };\n  \n  /**\n   * Revert the image src to the default value.\n   */\n  JustifiedGallery.prototype.resetImgSrc = function ($img) {\n    if ($img.data('jg.originalSrcLoc') === 'src') {\n      $img.attr('src', $img.data('jg.originalSrc'));\n    } else {\n      $img.attr('src', '');\n    }\n  };\n  \n  /**\n   * Destroy the Justified Gallery instance.\n   *\n   * It clears all the css properties added in the style attributes. We doesn't backup the original\n   * values for those css attributes, because it costs (performance) and because in general one\n   * shouldn't use the style attribute for an uniform set of images (where we suppose the use of\n   * classes). Creating a backup is also difficult because JG could be called multiple times and\n   * with different style attributes.\n   */\n  JustifiedGallery.prototype.destroy = function () {\n    clearInterval(this.checkWidthIntervalId);\n    this.stopImgAnalyzerStarter();\n  \n    // Get fresh entries list since filtered entries are absent in `this.entries`\n    $.each(this.getAllEntries(), $.proxy(function (_, entry) {\n      var $entry = $(entry);\n  \n      // Reset entry style\n      $entry.css('width', '');\n      $entry.css('height', '');\n      $entry.css('top', '');\n      $entry.css('left', '');\n      $entry.data('jg.loaded', undefined);\n      $entry.removeClass('jg-entry jg-filtered jg-entry-visible');\n  \n      // Reset image style\n      var $img = this.imgFromEntry($entry);\n      if ($img) {\n        $img.css('width', '');\n        $img.css('height', '');\n        $img.css('margin-left', '');\n        $img.css('margin-top', '');\n        this.resetImgSrc($img);\n        $img.data('jg.originalSrc', undefined);\n        $img.data('jg.originalSrcLoc', undefined);\n        $img.data('jg.src', undefined);\n      }\n  \n      // Remove caption\n      this.removeCaptionEventsHandlers($entry);\n      var $caption = this.captionFromEntry($entry);\n      if ($entry.data('jg.createdCaption')) {\n        // remove also the caption element (if created by jg)\n        $entry.data('jg.createdCaption', undefined);\n        if ($caption !== null) $caption.remove();\n      } else {\n        if ($caption !== null) $caption.fadeTo(0, 1);\n      }\n  \n    }, this));\n  \n    this.$gallery.css('height', '');\n    this.$gallery.removeClass('justified-gallery');\n    this.$gallery.data('jg.controller', undefined);\n    this.settings.triggerEvent.call(this, 'jg.destroy');\n  };\n  \n  /**\n   * Analyze the images and builds the rows. It returns if it found an image that is not loaded.\n   *\n   * @param isForResize if the image analyzer is called for resizing or not, to call a different callback at the end\n   */\n  JustifiedGallery.prototype.analyzeImages = function (isForResize) {\n    for (var i = this.lastAnalyzedIndex + 1; i < this.entries.length; i++) {\n      var $entry = $(this.entries[i]);\n      if ($entry.data('jg.loaded') === true || $entry.data('jg.loaded') === 'skipped') {\n        var availableWidth = this.galleryWidth - 2 * this.border - (\n          (this.buildingRow.entriesBuff.length - 1) * this.settings.margins);\n        var imgAspectRatio = $entry.data('jg.width') / $entry.data('jg.height');\n  \n        this.buildingRow.entriesBuff.push($entry);\n        this.buildingRow.aspectRatio += imgAspectRatio;\n        this.buildingRow.width += imgAspectRatio * this.settings.rowHeight;\n        this.lastAnalyzedIndex = i;\n  \n        if (availableWidth / (this.buildingRow.aspectRatio + imgAspectRatio) < this.settings.rowHeight) {\n          this.flushRow(false, this.settings.maxRowsCount > 0 && this.rows === this.settings.maxRowsCount);\n  \n          if (++this.yield.flushed >= this.yield.every) {\n            this.startImgAnalyzer(isForResize);\n            return;\n          }\n        }\n      } else if ($entry.data('jg.loaded') !== 'error') {\n        return;\n      }\n    }\n  \n    // Last row flush (the row is not full)\n    if (this.buildingRow.entriesBuff.length > 0) {\n      this.flushRow(true, this.settings.maxRowsCount > 0 && this.rows === this.settings.maxRowsCount);\n    }\n  \n    if (this.isSpinnerActive()) {\n      this.stopLoadingSpinnerAnimation();\n    }\n  \n    /* Stop, if there is, the timeout to start the analyzeImages.\n     This is because an image can be set loaded, and the timeout can be set,\n     but this image can be analyzed yet.\n     */\n    this.stopImgAnalyzerStarter();\n  \n    this.setGalleryFinalHeight(this.galleryHeightToSet);\n    \n    //On complete callback\n    this.settings.triggerEvent.call(this, isForResize ? 'jg.resize' : 'jg.complete');\n  };\n  \n  /**\n   * Stops any ImgAnalyzer starter (that has an assigned timeout)\n   */\n  JustifiedGallery.prototype.stopImgAnalyzerStarter = function () {\n    this.yield.flushed = 0;\n    if (this.imgAnalyzerTimeout !== null) {\n      clearTimeout(this.imgAnalyzerTimeout);\n      this.imgAnalyzerTimeout = null;\n    }\n  };\n  \n  /**\n   * Starts the image analyzer. It is not immediately called to let the browser to update the view\n   *\n   * @param isForResize specifies if the image analyzer must be called for resizing or not\n   */\n  JustifiedGallery.prototype.startImgAnalyzer = function (isForResize) {\n    var that = this;\n    this.stopImgAnalyzerStarter();\n    this.imgAnalyzerTimeout = setTimeout(function () {\n      that.analyzeImages(isForResize);\n    }, 0.001); // we can't start it immediately due to a IE different behaviour\n  };\n  \n  /**\n   * Checks if the image is loaded or not using another image object. We cannot use the 'complete' image property,\n   * because some browsers, with a 404 set complete = true.\n   *\n   * @param imageSrc the image src to load\n   * @param onLoad callback that is called when the image has been loaded\n   * @param onError callback that is called in case of an error\n   */\n  JustifiedGallery.prototype.onImageEvent = function (imageSrc, onLoad, onError) {\n    if (!onLoad && !onError) return;\n  \n    var memImage = new Image();\n    var $memImage = $(memImage);\n    if (onLoad) {\n      $memImage.one('load', function () {\n        $memImage.off('load error');\n        onLoad(memImage);\n      });\n    }\n    if (onError) {\n      $memImage.one('error', function () {\n        $memImage.off('load error');\n        onError(memImage);\n      });\n    }\n    memImage.src = imageSrc;\n  };\n  \n  /**\n   * Init of Justified Gallery controlled\n   * It analyzes all the entries starting theirs loading and calling the image analyzer (that works with loaded images)\n   */\n  JustifiedGallery.prototype.init = function () {\n    var imagesToLoad = false, skippedImages = false, that = this;\n    $.each(this.entries, function (index, entry) {\n      var $entry = $(entry);\n      var $image = that.imgFromEntry($entry);\n  \n      $entry.addClass('jg-entry');\n  \n      if ($entry.data('jg.loaded') !== true && $entry.data('jg.loaded') !== 'skipped') {\n  \n        // Link Rel global overwrite\n        if (that.settings.rel !== null) $entry.attr('rel', that.settings.rel);\n  \n        // Link Target global overwrite\n        if (that.settings.target !== null) $entry.attr('target', that.settings.target);\n  \n        if ($image !== null) {\n  \n          // Image src\n          var imageSrc = that.extractImgSrcFromImage($image);\n  \n          /* If we have the height and the width, we don't wait that the image is loaded, \n             but we start directly with the justification */\n          if (that.settings.waitThumbnailsLoad === false || !imageSrc) {\n            var width = parseFloat($image.attr('width'));\n            var height = parseFloat($image.attr('height'));\n            if ($image.prop('tagName') === 'svg') {\n              width = parseFloat($image[0].getBBox().width);\n              height = parseFloat($image[0].getBBox().height);\n            }\n            if (!isNaN(width) && !isNaN(height)) {\n              $entry.data('jg.width', width);\n              $entry.data('jg.height', height);\n              $entry.data('jg.loaded', 'skipped');\n              skippedImages = true;\n              that.startImgAnalyzer(false);\n              return true; // continue\n            }\n          }\n  \n          $entry.data('jg.loaded', false);\n          imagesToLoad = true;\n  \n          // Spinner start\n          if (!that.isSpinnerActive()) that.startLoadingSpinnerAnimation();\n  \n          that.onImageEvent(imageSrc, function (loadImg) { // image loaded\n            $entry.data('jg.width', loadImg.width);\n            $entry.data('jg.height', loadImg.height);\n            $entry.data('jg.loaded', true);\n            that.startImgAnalyzer(false);\n          }, function () { // image load error\n            $entry.data('jg.loaded', 'error');\n            that.startImgAnalyzer(false);\n          });\n  \n        } else {\n          $entry.data('jg.loaded', true);\n          $entry.data('jg.width', $entry.width() | parseFloat($entry.css('width')) | 1);\n          $entry.data('jg.height', $entry.height() | parseFloat($entry.css('height')) | 1);\n        }\n  \n      }\n  \n    });\n  \n    if (!imagesToLoad && !skippedImages) this.startImgAnalyzer(false);\n    this.checkWidth();\n  };\n  \n  /**\n   * Checks that it is a valid number. If a string is passed it is converted to a number\n   *\n   * @param settingContainer the object that contains the setting (to allow the conversion)\n   * @param settingName the setting name\n   */\n  JustifiedGallery.prototype.checkOrConvertNumber = function (settingContainer, settingName) {\n    if ($.type(settingContainer[settingName]) === 'string') {\n      settingContainer[settingName] = parseFloat(settingContainer[settingName]);\n    }\n  \n    if ($.type(settingContainer[settingName]) === 'number') {\n      if (isNaN(settingContainer[settingName])) throw 'invalid number for ' + settingName;\n    } else {\n      throw settingName + ' must be a number';\n    }\n  };\n  \n  /**\n   * Checks the sizeRangeSuffixes and, if necessary, converts\n   * its keys from string (e.g. old settings with 'lt100') to int.\n   */\n  JustifiedGallery.prototype.checkSizeRangesSuffixes = function () {\n    if ($.type(this.settings.sizeRangeSuffixes) !== 'object') {\n      throw 'sizeRangeSuffixes must be defined and must be an object';\n    }\n  \n    var suffixRanges = [];\n    for (var rangeIdx in this.settings.sizeRangeSuffixes) {\n      if (this.settings.sizeRangeSuffixes.hasOwnProperty(rangeIdx)) suffixRanges.push(rangeIdx);\n    }\n  \n    var newSizeRngSuffixes = { 0: '' };\n    for (var i = 0; i < suffixRanges.length; i++) {\n      if ($.type(suffixRanges[i]) === 'string') {\n        try {\n          var numIdx = parseInt(suffixRanges[i].replace(/^[a-z]+/, ''), 10);\n          newSizeRngSuffixes[numIdx] = this.settings.sizeRangeSuffixes[suffixRanges[i]];\n        } catch (e) {\n          throw 'sizeRangeSuffixes keys must contains correct numbers (' + e + ')';\n        }\n      } else {\n        newSizeRngSuffixes[suffixRanges[i]] = this.settings.sizeRangeSuffixes[suffixRanges[i]];\n      }\n    }\n  \n    this.settings.sizeRangeSuffixes = newSizeRngSuffixes;\n  };\n  \n  /**\n   * check and convert the maxRowHeight setting\n   * requires rowHeight to be already set\n   * TODO: should be always called when only rowHeight is changed\n   * @return number or null\n   */\n  JustifiedGallery.prototype.retrieveMaxRowHeight = function () {\n    var newMaxRowHeight = null;\n    var rowHeight = this.settings.rowHeight;\n  \n    if ($.type(this.settings.maxRowHeight) === 'string') {\n      if (this.settings.maxRowHeight.match(/^[0-9]+%$/)) {\n        newMaxRowHeight = rowHeight * parseFloat(this.settings.maxRowHeight.match(/^([0-9]+)%$/)[1]) / 100;\n      } else {\n        newMaxRowHeight = parseFloat(this.settings.maxRowHeight);\n      }\n    } else if ($.type(this.settings.maxRowHeight) === 'number') {\n      newMaxRowHeight = this.settings.maxRowHeight;\n    } else if (this.settings.maxRowHeight === false || this.settings.maxRowHeight == null) {\n      return null;\n    } else {\n      throw 'maxRowHeight must be a number or a percentage';\n    }\n  \n    // check if the converted value is not a number\n    if (isNaN(newMaxRowHeight)) throw 'invalid number for maxRowHeight';\n  \n    // check values, maxRowHeight must be >= rowHeight\n    if (newMaxRowHeight < rowHeight) newMaxRowHeight = rowHeight;\n  \n    return newMaxRowHeight;\n  };\n  \n  /**\n   * Checks the settings\n   */\n  JustifiedGallery.prototype.checkSettings = function () {\n    this.checkSizeRangesSuffixes();\n  \n    this.checkOrConvertNumber(this.settings, 'rowHeight');\n    this.checkOrConvertNumber(this.settings, 'margins');\n    this.checkOrConvertNumber(this.settings, 'border');\n    this.checkOrConvertNumber(this.settings, 'maxRowsCount');\n  \n    var lastRowModes = [\n      'justify',\n      'nojustify',\n      'left',\n      'center',\n      'right',\n      'hide'\n    ];\n    if (lastRowModes.indexOf(this.settings.lastRow) === -1) {\n      throw 'lastRow must be one of: ' + lastRowModes.join(', ');\n    }\n  \n    this.checkOrConvertNumber(this.settings, 'justifyThreshold');\n    if (this.settings.justifyThreshold < 0 || this.settings.justifyThreshold > 1) {\n      throw 'justifyThreshold must be in the interval [0,1]';\n    }\n    if ($.type(this.settings.cssAnimation) !== 'boolean') {\n      throw 'cssAnimation must be a boolean';\n    }\n  \n    if ($.type(this.settings.captions) !== 'boolean') throw 'captions must be a boolean';\n    this.checkOrConvertNumber(this.settings.captionSettings, 'animationDuration');\n  \n    this.checkOrConvertNumber(this.settings.captionSettings, 'visibleOpacity');\n    if (this.settings.captionSettings.visibleOpacity < 0 ||\n      this.settings.captionSettings.visibleOpacity > 1) {\n      throw 'captionSettings.visibleOpacity must be in the interval [0, 1]';\n    }\n  \n    this.checkOrConvertNumber(this.settings.captionSettings, 'nonVisibleOpacity');\n    if (this.settings.captionSettings.nonVisibleOpacity < 0 ||\n      this.settings.captionSettings.nonVisibleOpacity > 1) {\n      throw 'captionSettings.nonVisibleOpacity must be in the interval [0, 1]';\n    }\n  \n    this.checkOrConvertNumber(this.settings, 'imagesAnimationDuration');\n    this.checkOrConvertNumber(this.settings, 'refreshTime');\n    this.checkOrConvertNumber(this.settings, 'refreshSensitivity');\n    if ($.type(this.settings.randomize) !== 'boolean') throw 'randomize must be a boolean';\n    if ($.type(this.settings.selector) !== 'string') throw 'selector must be a string';\n  \n    if (this.settings.sort !== false && !$.isFunction(this.settings.sort)) {\n      throw 'sort must be false or a comparison function';\n    }\n  \n    if (this.settings.filter !== false && !$.isFunction(this.settings.filter) &&\n      $.type(this.settings.filter) !== 'string') {\n      throw 'filter must be false, a string or a filter function';\n    }\n  };\n  \n  /**\n   * It brings all the indexes from the sizeRangeSuffixes and it orders them. They are then sorted and returned.\n   * @returns {Array} sorted suffix ranges\n   */\n  JustifiedGallery.prototype.retrieveSuffixRanges = function () {\n    var suffixRanges = [];\n    for (var rangeIdx in this.settings.sizeRangeSuffixes) {\n      if (this.settings.sizeRangeSuffixes.hasOwnProperty(rangeIdx)) suffixRanges.push(parseInt(rangeIdx, 10));\n    }\n    suffixRanges.sort(function (a, b) { return a > b ? 1 : a < b ? -1 : 0; });\n    return suffixRanges;\n  };\n  \n  /**\n   * Update the existing settings only changing some of them\n   *\n   * @param newSettings the new settings (or a subgroup of them)\n   */\n  JustifiedGallery.prototype.updateSettings = function (newSettings) {\n    // In this case Justified Gallery has been called again changing only some options\n    this.settings = $.extend({}, this.settings, newSettings);\n    this.checkSettings();\n  \n    // As reported in the settings: negative value = same as margins, 0 = disabled\n    this.border = this.settings.border >= 0 ? this.settings.border : this.settings.margins;\n  \n    this.maxRowHeight = this.retrieveMaxRowHeight();\n    this.suffixRanges = this.retrieveSuffixRanges();\n  };\n  \n  JustifiedGallery.prototype.defaults = {\n    sizeRangeSuffixes: {}, /* e.g. Flickr configuration\n        {\n          100: '_t',  // used when longest is less than 100px\n          240: '_m',  // used when longest is between 101px and 240px\n          320: '_n',  // ...\n          500: '',\n          640: '_z',\n          1024: '_b'  // used as else case because it is the last\n        }\n    */\n    thumbnailPath: undefined, /* If defined, sizeRangeSuffixes is not used, and this function is used to determine the\n    path relative to a specific thumbnail size. The function should accept respectively three arguments:\n    current path, width and height */\n    rowHeight: 120, // required? required to be > 0?\n    maxRowHeight: false, // false or negative value to deactivate. Positive number to express the value in pixels,\n    // A string '[0-9]+%' to express in percentage (e.g. 300% means that the row height\n    // can't exceed 3 * rowHeight)\n    maxRowsCount: 0, // maximum number of rows to be displayed (0 = disabled)\n    margins: 1,\n    border: -1, // negative value = same as margins, 0 = disabled, any other value to set the border\n  \n    lastRow: 'nojustify', //  which is the same as 'left', or can be 'justify', 'center', 'right' or 'hide'\n  \n    justifyThreshold: 0.90, /* if row width / available space > 0.90 it will be always justified\n                             * (i.e. lastRow setting is not considered) */\n    waitThumbnailsLoad: true,\n    captions: true,\n    cssAnimation: true,\n    imagesAnimationDuration: 500, // ignored with css animations\n    captionSettings: { // ignored with css animations\n      animationDuration: 500,\n      visibleOpacity: 0.7,\n      nonVisibleOpacity: 0.0\n    },\n    rel: null, // rewrite the rel of each analyzed links\n    target: null, // rewrite the target of all links\n    extension: /\\.[^.\\\\/]+$/, // regexp to capture the extension of an image\n    refreshTime: 200, // time interval (in ms) to check if the page changes its width\n    refreshSensitivity: 0, // change in width allowed (in px) without re-building the gallery\n    randomize: false,\n    rtl: false, // right-to-left mode\n    sort: false, /*\n      - false: to do not sort\n      - function: to sort them using the function as comparator (see Array.prototype.sort())\n    */\n    filter: false, /*\n      - false, null or undefined: for a disabled filter\n      - a string: an entry is kept if entry.is(filter string) returns true\n                  see jQuery's .is() function for further information\n      - a function: invoked with arguments (entry, index, array). Return true to keep the entry, false otherwise.\n                    It follows the specifications of the Array.prototype.filter() function of JavaScript.\n    */\n    selector: 'a', // The selector that is used to know what are the entries of the gallery\n    imgSelector: '> img, > a > img, > svg, > a > svg', // The selector that is used to know what are the images of each entry\n    triggerEvent: function (event) { // This is called to trigger events, the default behavior is to call $.trigger\n      this.$gallery.trigger(event);  // Consider that 'this' is this set to the JustifiedGallery object, so it can\n    }                                // access to fields such as $gallery, useful to trigger events with jQuery.\n  };\n  \n\n  /**\n   * Justified Gallery plugin for jQuery\n   *\n   * Events\n   *  - jg.complete : called when all the gallery has been created\n   *  - jg.resize : called when the gallery has been resized\n   *  - jg.rowflush : when a new row appears\n   *\n   * @param arg the action (or the settings) passed when the plugin is called\n   * @returns {*} the object itself\n   */\n  $.fn.justifiedGallery = function (arg) {\n    return this.each(function (index, gallery) {\n\n      var $gallery = $(gallery);\n      $gallery.addClass('justified-gallery');\n\n      var controller = $gallery.data('jg.controller');\n      if (typeof controller === 'undefined') {\n        // Create controller and assign it to the object data\n        if (typeof arg !== 'undefined' && arg !== null && $.type(arg) !== 'object') {\n          if (arg === 'destroy') return; // Just a call to an unexisting object\n          throw 'The argument must be an object';\n        }\n        controller = new JustifiedGallery($gallery, $.extend({}, JustifiedGallery.prototype.defaults, arg));\n        $gallery.data('jg.controller', controller);\n      } else if (arg === 'norewind') {\n        // In this case we don't rewind: we analyze only the latest images (e.g. to complete the last unfinished row\n        // ... left to be more readable\n      } else if (arg === 'destroy') {\n        controller.destroy();\n        return;\n      } else {\n        // In this case Justified Gallery has been called again changing only some options\n        controller.updateSettings(arg);\n        controller.rewind();\n      }\n\n      // Update the entries list\n      if (!controller.updateEntries(arg === 'norewind')) return;\n\n      // Init justified gallery\n      controller.init();\n\n    });\n  };\n\n}));","module.exports = window[\"jQuery\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module used 'module' so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/frontend/libs/gallery/jquery.justified.js\");\n",""],"names":["factory","define","amd","module","exports","root","jQuery","undefined","window","require","$","JustifiedGallery","$gallery","settings","checkSettings","imgAnalyzerTimeout","entries","buildingRow","entriesBuff","width","height","aspectRatio","lastFetchedEntry","lastAnalyzedIndex","yield","every","flushed","border","margins","maxRowHeight","retrieveMaxRowHeight","suffixRanges","retrieveSuffixRanges","offY","rows","spinner","phase","timeSlot","$el","intervalId","scrollBarOn","checkWidthIntervalId","galleryWidth","prototype","getSuffix","longestSide","i","length","sizeRangeSuffixes","removeSuffix","str","suffix","substring","endsWith","indexOf","getUsedSuffix","si","hasOwnProperty","newSrc","imageSrc","imgWidth","imgHeight","image","newImageSrc","thumbnailPath","matchRes","match","extension","ext","replace","showImg","$entry","callback","cssAnimation","addClass","stop","fadeTo","imagesAnimationDuration","find","imgSelector","extractImgSrcFromImage","$image","data","imageSrcLoc","attr","imgFromEntry","$img","captionFromEntry","$caption","displayEntry","x","y","rowHeight","css","one","resetImgSrc","loadNewImage","onImageEvent","bind","displayEntryCaption","captions","$imgCaption","caption","isValidCaption","append","captionSettings","nonVisibleOpacity","addCaptionEventsHandlers","removeCaptionEventsHandlers","onEntryMouseEnterForCaption","eventObject","currentTarget","removeClass","animationDuration","visibleOpacity","onEntryMouseLeaveForCaption","captionMouseEvents","mouseenter","proxy","mouseleave","on","off","removeData","clearBuildingRow","prepareBuildingRow","isLastRow","hiddenRow","imgAspectRatio","newImgW","newImgH","justify","minHeight","availableWidth","defaultRowHeight","justifiable","justifyThreshold","lastRow","Math","round","ceil","flushRow","buildingRowRes","offX","lastEntryIdx","rtl","galleryHeightToSet","setGalleryTempHeight","getSpinnerHeight","triggerEvent","call","galleryPrevStaticHeight","rememberGalleryHeight","max","setGalleryFinalHeight","checkWidth","setInterval","is","parseFloat","abs","refreshSensitivity","rewind","startImgAnalyzer","refreshTime","isSpinnerActive","innerHeight","stopLoadingSpinnerAnimation","clearInterval","detach","startLoadingSpinnerAnimation","spinnerContext","$spinnerPoints","eq","getSelectorWithoutSpinner","selector","getAllEntries","children","toArray","updateEntries","norewind","newEntries","nextAll","isFunction","sort","sortArray","randomize","shuffleArray","filter","filterArray","resetFilters","concat","insertToGallery","that","each","appendTo","a","j","temp","floor","random","type","el","filteredArr","destroy","stopImgAnalyzerStarter","_","entry","remove","analyzeImages","isForResize","push","maxRowsCount","clearTimeout","setTimeout","onLoad","onError","memImage","Image","$memImage","src","init","imagesToLoad","skippedImages","index","rel","target","waitThumbnailsLoad","prop","getBBox","isNaN","loadImg","checkOrConvertNumber","settingContainer","settingName","checkSizeRangesSuffixes","rangeIdx","newSizeRngSuffixes","numIdx","parseInt","e","newMaxRowHeight","lastRowModes","join","b","updateSettings","newSettings","extend","defaults","event","trigger","fn","justifiedGallery","arg","gallery","controller"],"sourceRoot":""}